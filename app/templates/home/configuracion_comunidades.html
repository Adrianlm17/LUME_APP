{% extends "layouts/base_app.html" %}

{% block title %} CONFIG COMUNIDAD | LUME {% endblock %} 

{% block content %}

{% if comunidad_seleccionada|length > 1 %}
<div class="row">
    <div class="col-md-12">
        <h2>Configurar Comunidad {{ comunidad_seleccionada.nombre }}</h2>
        <form method="post" action="">
            {% csrf_token %}
            <select name="comunidad_seleccionada">
                {% for comunidad in comunidades %}
                    <option value="{{ comunidad.id }}" {% if comunidad.id == comunidad_seleccionada.id %}selected{% endif %}>{{ comunidad.nombre }}</option>
                {% endfor %}
            </select>
            <button type="submit" class="btn btn-primary">Cambiar comunidad</button>
        </form>
    </div>
</div>
{% endif %}

{% if success %}
  <div class="alert alert-success alert-dismissible">
    <a href="" class="close" data-dismiss="alert" aria-label="close">&times;</a>
    <strong>¡ACTUALIZADA!</strong> Comunidad actualizada correctamente
  </div> 
{% endif %} 

<div class="row">
  <div class="col-md-6">
      <div class="card">
        <div class="card-header card-header-primary">
            <h4 class="card-title">Editar Comunidad</h4>
        </div>
        <div class="card-body">

          {% if msg %}
            <br>
            <h6 class="card-category">
              <span class="text-danger">{{ msg | safe }}</span>
            </h6>
          {% endif %}  

          <br>

          <form method="post">
            {% csrf_token %}
            {% for field in form %}
              <div class="form-group">
                <h4>{{ field.label }}</h4>
                {{ field }}
              </div>
              <br>
            {% endfor %}
            
            <div class="form-group">
              <h4>Token</h4>
              <input type="text" name="token" value="{% if comunidad_seleccionada %}{{ comunidad_seleccionada.token }}{% endif %}" class="form-control text-center" readonly>
            </div>
            
            <button type="submit">Guardar cambios</button>
          </form>
        </div>        
      </div>
  </div> 

  <div class="col-md-6">
    <div class="card">
      <div class="card-header card-header-primary">
        <h4 class="card-title">Anuncio Comunidad</h4>
      </div>
      <div class="card-body">
        <form method="post" action="{% url 'home:comunidades_configuracion' comunidad_seleccionada.id %}">
          {% csrf_token %}
          <div class="form-group titulo">
            <h4>Titulo:</h4>
            {{ crear_anuncio_form.titulo }}
          </div>
          <div class="form-group descripcion">
            <h4>Descripción:</h4>
            {{ crear_anuncio_form.descripcion }}
          </div>
          <div class="form-group descripcion">
            <h4>Fecha:</h4>
            {{ crear_anuncio_form.fecha_anuncio }}
          </div>

          <br>

          <button type="submit" class="btn btn-primary">Enviar Anuncio</button>
        </form>
      </div>       
    </div>

    <br>

    <div class="card">
      <div class="card-header card-header-primary">
        <h4 class="card-title">Administrar Viviendas</h4>
      </div>
      <div class="card-body">
        <p>
          Administra las viviendas de tu comunidad, permitiendo añadir, modificar o incluso expulsar a miembros de tu comunidad!
        </p>
        <a href="{% url 'home:administrar_viviendas' comunidad_seleccionada.id %}" class="btn btn-primary">Administrar Viviendas</a>
      </div>
    </div>

    <br>

    <div class="card">
      <div class="card-header card-header-primary">
        <h4 class="card-title">Administrar Distribución de Gastos</h4>
      </div>
      <div class="card-body">
        <p>
          Administra la distribución de los gastos de tu comunidad, permitiendo pagar por iguales o pagar por porcentajes!
        </p>
        <a href="{% url 'home:administrar_distribucion_gastos' comunidad_seleccionada.id %}" class="btn btn-primary">Administrar Distribución de Gastos</a>
      </div>
    </div>

  </div>
</div>

<div class="card">
    <div class="card-header card-header-primary">
      <h4 class="card-title">Seguro de la Comunidad</h4>
    </div>
    <div class="card-body">
      <form method="post" action="{% url 'home:comunidades_configuracion' comunidad_seleccionada.id %}">
        {% csrf_token %}
        {% for field in seguro_comunidad_form %}
          <div class="form-group">
            <h4>{{ field.label }}</h4>
            {{ field }}
          </div>
          <br>
        {% endfor %}
        <button type="submit" class="btn btn-primary">Guardar Seguro</button>
      </form>
    </div>       
  </div>

</div>

</div>


<style>
  .titulo input{
    width: 100%; 
    cols: 50; 
  }

  .descripcion textarea{
    width: 100%; 
    cols: 50; 
  }
</style>
{% endblock content %}
